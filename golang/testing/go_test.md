# Go Test

- [Go Test](#go-test)
    - [테스트](#테스트)
    - [패키지 단위로 테스트 수행](#패키지-단위로-테스트-수행)
    - [특정 패키지의 커버리지 확인](#특정-패키지의-커버리지-확인)
    - [커버리지 결과 분석](#커버리지-결과-분석)
    - [하위 패키지 제외하고 현재 패키지만 테스트](#하위-패키지-제외하고-현재-패키지만-테스트)

## 테스트

주로 Go의 테스트 도구는 패키지 단위로 테스트를 수행한다.
Go에서는 패키지 내의 모든 파일이 함께 컴파일되어야 한다.
따라서, 단일 파일을 지정하여 테스트를 수행하려 할 때, 그 파일이 참조하는 다른 파일이나 식별자가 없어서 문제가 발생한다.

`*` 와일드카드를 사용하거나 파일 이름을 직접 지정하는 방식은 Go 테스트 도구에서 직접적으로 지원되지 않는다.
대신, 특정 파일의 커버리지를 측정하고 싶다면, 해당 파일이 포함된 패키지 전체를 테스트 대상으로 지정하고, 커버리지 결과에서 관심 있는 파일의 커버리지를 확인해야 한다.

## 패키지 단위로 테스트 수행

패키지 단위로 테스트를 실행하고 커버리지를 측정하는 명령어

```bash
# 현재 디렉토리와 그 하위의 모든 패키지에 대해 테스트를 수행하고 커버리지 데이터를 `coverage.out` 파일에 저장합니다.
go test -count=1 -v -coverprofile=coverage.out -cover ./...
```

## 특정 패키지의 커버리지 확인

특정 파일의 커버리지를 확인하려면, 해당 파일이 속한 패키지의 경로를 명시적으로 지정해야 한다.
예를 들어, `authentication` 패키지의 커버리지를 확인하고 싶은 경우:

```bash
# 해당 패키지의 모든 파일이 컴파일되고 테스트되며, 커버리지 데이터가 생성된다.
go test -count=1 -v -coverprofile=coverage.out -cover ./path/to/authentication
```

## 커버리지 결과 분석

커버리지 결과 파일(`coverage.out`)에서 특정 파일의 커버리지 정보를 확인하려면,
`go tool cover` 명령어를 사용하여 커버리지 결과를 분석할 수 있다.

```bash
go tool cover -func=coverage.out
```

이 명령어는 함수 별 커버리지 요약을 출력하며, 여기서 특정 파일의 커버리지를 확인할 수 있다.
파일별로 세분화된 커버리지 정보를 보려면, HTML 보고서를 생성할 수 있다.

```bash
go tool cover -html=coverage.out -o coverage.html
```

## 하위 패키지 제외하고 현재 패키지만 테스트

```bash
# ./... 대신 ./만 사용하면 된다
go test -count=1 -v -coverprofile=coverage.out -cover ./
```
