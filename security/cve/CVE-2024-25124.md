# [CVE-2024-25124](https://devhub.checkmarx.com/cve-details/CVE-2024-25124/)

## ORIGIN VALIDATION ERROR IN GITHUB.COM/GOFIBER/FIBER

Fiber는 Go로 작성된 웹 프레임워크입니다. 버전 `2.52.1` 이전에는 CORS 미들웨어를 사용하면 애플리케이션이 여러 CORS 관련 취약점에 노출될 수 있는 안전하지 않은 구성이 허용되었습니다.

특히, `Access-Control-Allow-Origin` 헤더를 와일드카드('*')로 설정하는 동시에 `Access-Control-Allow-Credentials`를 true로 설정할 수 있는데, 이는 권장 보안 모범 사례에 위배되는 설정입니다.

이러한 잘못된 구성은 민감한 사용자 데이터에 대한 무단 액세스로 이어질 수 있고 참고 문헌에 링크된 PortSwigger 문서에 나열된 다양한 유형의 공격에 시스템을 노출시킬 수 있으므로 그 영향은 매우 큽니다.

해결 방법으로, 사용자는 자격 증명이 활성화된 경우 와일드카드 출처를 허용하지 않도록 구현에서 CORS 구성의 유효성을 수동으로 검사할 수 있습니다. 브라우저 fetch API와 CORS 정책을 적용하는 브라우저 및 유틸리티는 이 문제에 영향을 받지 않습니다.

## 해결 방법

```go
func New(config ...Config) fiber.Handler {
    if cfg.AllowCredentials && cfg.AllowOrigins == "*" {
        panic("[CORS] Insecure setup, 'AllowCredentials' is set to true, and 'AllowOrigins' is set to a wildcard.")
    }
    // Return new handler goes below
}
```

The middleware will not allow insecure configurations when using `AllowCredentials` and `AllowOrigins`.

## 기타

- [Fiber has Insecure CORS Configuration, Allowing Wildcard Origin with Credentials](https://github.com/advisories/GHSA-fmg4-x8pw-hjhg)
