# crontab

- [crontab](#crontab)
    - [crontab에 대한 설명](#crontab에-대한-설명)
    - [crontab 파일 구조](#crontab-파일-구조)
    - [crontab 명령어 사용 예](#crontab-명령어-사용-예)
        - [예시](#예시)
    - [크론탭의 작동 방식](#크론탭의-작동-방식)
    - [주의사항](#주의사항)
    - [Examples](#examples)
        - [실행중인 크론탭 확인](#실행중인-크론탭-확인)

## crontab에 대한 설명

`crontab`은 UNIX 및 UNIX 계열 시스템에서 시간 기반 작업 스케줄링을 관리하는 데 사용되는 명령어입니다. 사용자는 `crontab`을 사용하여 반복적인 작업을 자동으로 실행하도록 시스템에 지시할 수 있습니다. 이러한 작업은 데이터 백업, 시스템 업데이트 확인, 정기적인 데이터 처리 등 다양할 수 있습니다.

## crontab 파일 구조

`crontab` 파일은 다섯 개의 시간 및 날짜 필드, 실행할 명령어로 구성된 여러 줄의 항목으로 구성됩니다. 각 줄은 하나의 작업을 나타냅니다.

```text
분 시 일 월 요일 명령어
```

- **분**: 0에서 59 사이의 값
- **시**: 0에서 23 사이의 값 (0은 자정을 의미)
- **일**: 1에서 31 사이의 값
- **월**: 1에서 12 사이의 값 또는 JAN, FEB 등의 약어
- **요일**: 0에서 6 사이의 값 (0은 일요일), 또는 SUN, MON 등의 약어
- **명령어**: 실행할 명령어

## crontab 명령어 사용 예

- `crontab -e`: 현재 사용자의 crontab 파일을 편집합니다.
- `crontab -l`: 현재 사용자의 crontab 파일 내용을 표시합니다.
- `crontab -r`: 현재 사용자의 crontab 파일을 삭제합니다.

### 예시

매일 자정에 "backup.sh" 스크립트를 실행하는 crontab 항목:

```text
0 0 * * * /path/to/backup.sh
```

매주 월요일 오전 8시 30분에 "update.sh" 스크립트를 실행하는 crontab 항목:

```text
30 8 * * 1 /path/to/update.sh
```

## 크론탭의 작동 방식

`crontab`이 작업을 스케줄링하고 실행하는 방식은 일반적인 프로그래밍 언어에서 사용하는 `while` 루프와는 다르다.
`crontab`은 시스템의 `cron` 데몬에 의해 관리되며, 이 데몬은 시스템이 부팅될 때 시작되어 백그라운드에서 계속 실행된다.
`cron` 데몬의 작동 방식은 다음과 같습니다:

1. **스케줄 로드**: 시스템이 시작될 때, `cron` 데몬은 `/var/spool/cron` 디렉토리(또는 시스템에 따라 다를 수 있음)에 있는 모든 사용자의 `crontab` 파일들을 로드하여 각 작업의 스케줄을 메모리에 저장합니다.

2. **시간 체크**: `cron` 데몬은 일정 시간 간격(일반적으로 1분)마다 현재 시간을 체크하고, 메모리에 로드된 스케줄과 비교합니다.

3. **작업 실행**: 현재 시간이 어떤 작업의 스케줄과 일치하면, `cron` 데몬은 해당 작업을 실행합니다. 작업 실행은 시스템의 쉘을 통해 이루어지며, 작업이 완료되면 다음 실행 시간까지 대기합니다.

4. **로그 기록**: 작업 실행 결과는 시스템의 로그 파일에 기록될 수 있으며, 사용자가 이메일로 결과를 받도록 설정할 수도 있습니다.

`cron` 데몬은 효율적인 시간 관리와 시스템 리소스 사용을 위해 최적화되어 있으며, 사용자가 직접 `while` 루프를 작성하여 시간을 체크하고 작업을 실행하는 것보다 훨씬 더 효율적입니다. 이러한 방식으로 `cron`은 시스템의 부하를 최소화하면서도 정확한 시간에 작업을 실행할 수 있습니다.

## 주의사항

- `crontab` 파일을 편집할 때는 문법을 정확히 지켜야 합니다. 잘못된 문법은 작업이 예상대로 실행되지 않을 수 있습니다.
- 스크립트나 명령어의 절대 경로를 사용하는 것이 좋습니다.
- `crontab`은 시스템이 실행 중일 때만 작업을 실행할 수 있습니다. 시스템이 꺼져 있을 때 예정된 작업은 실행되지 않습니다.

## Examples

### 실행중인 크론탭 확인

```bash
for user in $(cut -f1 -d: /etc/passwd); do crontab -u $user -l; done
```
