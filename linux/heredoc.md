# heredoc

## heredoc?

Heredoc (Here Document)은 쉘 스크립트나 프로그래밍 언어에서 여러 줄에 걸친 문자열을 정의할 때 사용하는 기법입니다. 이 방식은 특히 긴 문자열이나 구성 파일, SQL 쿼리와 같이 여러 줄로 이루어진 텍스트를 직접 스크립트 안에 포함시킬 때 유용합니다.

Heredoc은 `<<` 연산자를 사용하여 시작됩니다. 이 연산자 다음에는 종료 식별자를 지정하며, 이 식별자는 문자열의 끝을 나타냅니다. 식별자는 대소문자를 구분하며, 일반적으로 대문자를 사용하는 것이 관례입니다.

```bash
cat <<EOF
여러 줄에 걸친
텍스트를 여기에
작성할 수 있습니다.
EOF
```

- **일반 식별자**: 변수 확장, 명령어 치환, 특수 문자 해석이 일어납니다.
- **작은따옴표로 둘러싼 식별자**: 변수 확장, 명령어 치환, 특수 문자 해석이 일어나지 않습니다.
- **큰따옴표로 둘러싼 식별자**: 변수는 확장되지만, 명령어 치환과 특수 문자 해석은 일어나지 않습니다.
- **역따옴표로 둘러싼 식별자**: 사용되지 않는 일반적인 형태입니다.

- **식별자 앞에 `-` 추가**: 이 옵션을 사용하면 heredoc의 시작과 끝에 들여쓰기를 할 수 있습니다. 이는 스크립트의 가독성을 높이는 데 도움이 됩니다.
  
  ```bash
  cat <<-EOF
      이 텍스트는 들여쓰기가 가능합니다.
      들여쓰기된 텍스트도 정상적으로 처리됩니다.
  EOF
  ```

- **파일로 리다이렉션**: Heredoc을 사용하여 파일에 직접 쓸 수 있습니다. 이는 설정 파일을 생성하거나, 특정 데이터를 파일로 저장할 때 유용합니다.

  ```bash
  cat <<EOF > output.txt
  여기에 쓰인 텍스트는 output.txt 파일에 저장됩니다.
  EOF
  ```

## Heredoc의 동작 방식

Heredoc은 스크립트 내에서 다중 라인의 문자열을 입력으로 사용할 수 있게 해주는 기능입니다. 일반적으로 `<<` 다음에 오는 토큰(이 경우 `EOF`)을 사용하여 문자열의 시작과 끝을 표시합니다.

## 주의사항

- **식별자 일치**: 시작 식별자와 종료 식별자가 정확히 일치해야 합니다.
- **공백 처리**: `-` 옵션을 사용하지 않는 경우, 종료 식별자 앞에 공백이 있으면 안 됩니다.

## 홑따옴표 붙이는 이유

`<<'EOF' ... EOF`에서 첫 번째 `EOF`를 홑따옴표(`'`)로 감싸는 이유는 Bash 스크립트에서 heredoc(Here Document)를 사용할 때 문자열 내의 특수 문자나 변수가 확장되는 것을 방지하기 위함입니다.
홑따옴표로 감싸면, heredoc 내의 내용이 그대로 문자열로 처리되며, 변수나 명령어 치환 등이 발생하지 않습니다.

- **변수 확장 방지**

    홑따옴표로 둘러싸인 heredoc에서는 `$variable` 같은 변수가 그대로 출력됩니다.
    변수의 값으로 확장되지 않습니다.

- **명령어 실행 방지**

    `$(command)` 또는 `` `command` `` 형태의 명령어 치환도 실행되지 않고, 문자 그대로 출력됩니다.

- **특수 문자의 리터럴 처리**

    예를 들어, heredoc 내에서 `\n`, `\t` 같은 특수 문자가 실제 개행이나 탭으로 처리되지 않고 문자 그대로 유지됩니다.

```bash
cat <<'EOF'
This is a line with a variable $HOME and a command $(ls).
EOF
```

위 스크립트를 실행하면, `$HOME`과 `$(ls)`가 변수 확장이나 명령어 실행 없이 그대로 출력됩니다.
