# class

- [class](#class)
    - [`::class` 키워드](#class-키워드)
    - [클래스가 실제로 사용될 때?](#클래스가-실제로-사용될-때)

## `::class` 키워드

PHP에서 `::class` 키워드를 사용하는 것은 클래스의 전체 이름을 문자열로 반환하는 컴파일 타임 변환입니다.
이 변환은 PHP 스크립트가 실행되기 전에, 즉 런타임에 도달하기 전에 발생합니다.
따라서 이 시점에서는 아직 클래스가 실제로 존재하는지, 또는 오토로딩이 필요한지 여부를 검사하지 않습니다.

1. 클래스 이름 해석 (Class Name Resolution)

    PHP의 `::class`는 클래스의 완전한 네임스페이스를 포함한 이름을 문자열로 반환하는 *컴파일 타임 상수*입니다.
    `::class`를 사용한 표현식은 실제로 *컴파일 타임에 문자열로 변환*됩니다.
    즉, 코드가 실행되기 전에 이미 문자열로 변환되어 있습니다.

    이 변환 과정에서는 *클래스의 존재 여부를 확인하지 않으므로, 오토로딩이 트리거되지 않습니다*.

    ```php
    <?php
    print Does\Not\Exist::class;
    ?>
    ```

    위 코드는 다음과 같이 동작합니다:

    1. 컴파일 타임에 `Does\Not\Exist::class`는 `"Does\Not\Exist"`로 변환됩니다.
    2. 런타임시 변환된 문자열 `"Does\Not\Exist"`가 `print` 함수에 전달되어 출력됩니다.

2. 오토로딩 (Autoloading)

    PHP의 오토로딩은 *클래스가 실제로 사용될 때 해당 클래스 파일을 찾아 로드*하는 메커니즘입니다.

    클래스 이름을 단순히 문자열로 변환하는 `::class` 사용 시점에는 오토로딩이 트리거되지 않습니다.
    클래스가 실제로 필요할 때(예: 인스턴스화) 오토로딩이 발생합니다.

3. 내부 메모리 접근 방식

    PHP의 컴파일러와 런타임은 다음과 같은 방식으로 작동합니다:

    - 컴파일 타임

        스크립트가 실행되기 전에, PHP 코드는 중간 코드인 바이트코드(Zend opcodes)로 변환됩니다.
        이 단계에서는 코드의 구문을 분석하고, 변수명이나 함수명, 클래스명 등을 해석합니다.

        이 과정에서 `::class`는 문자열로 변환됩니다.
        `::class`는 단순히 문자열로 변환되므로, 이 시점에서는 클래스의 존재 여부를 확인하지 않습니다.

    - 런타임

        실제로 opcode를 실행하면서 PHP 스크립트가 동작합니다.
        클래스나 메서드를 호출할 때 런타임에서 해당 클래스가 메모리에 로드됩니다.
        클래스의 존재 여부, 파일의 입출력, 데이터베이스 접근 등이 이루어집니다.

        이 시점에서 오토로딩이 필요할 수 있습니다.

        클래스의 실제 사용 시점에서 오토로딩을 통해 클래스가 로드됩니다.
        존재하지 않는 클래스를 호출하거나 인스턴스화하려 할 때 비로소 오류가 발생합니다.

        `print Does\Not\Exist::class;`는 문자열 `"Does\Not\Exist"`가 `print`에 전달되됩니다.
        이는 단순 문자열 변환이므로 오토로딩이 트리거되지 않습니다.

## 클래스가 실제로 사용될 때?

클래스를 "실제로 사용한다"는 것은 클래스 정의가 메모리에 로드되고, 그와 관련된 작업이 수행되는 것을 의미합니다.

1. 인스턴스화 (Instantiation): 클래스로부터 객체를 생성하는 경우.

    ```php
    $obj = new MyClass();
    ```

    `new` 키워드를 사용하여 클래스의 인스턴스를 생성할 때 PHP는
    1. 해당 클래스 정의를 메모리에 로드하고,
    2. 생성자를 호출하여 객체를 초기화합니다.

2. 정적 메서드 호출 (Static Method Call): 클래스의 정적 메서드를 호출하는 경우.

    ```php
    MyClass::myStaticMethod();
    ```

    정적 메서드를 호출할 때 PHP는
    1. 해당 클래스 정의를 메모리에 로드하고,
    2. 정적 메서드를 실행합니다.

3. 정적 속성 접근 (Static Property Access): 클래스의 정적 속성에 접근하는 경우.

    ```php
    MyClass::$myStaticProperty;
    ```

    정적 속성에 접근할 때 PHP는
    1. 해당 클래스 정의를 메모리에 로드하고,
    2. 정적 속성 값을 반환합니다.

4. 클래스 상속 (Inheritance): 클래스를 상속받는 다른 클래스가 정의될 때.

    ```php
    class MySubClass extends MyClass {}
    ```

    상속 관계를 설정할 때 PHP는
    1. 부모 클래스 정의를 메모리에 로드하여
    2. 자식 클래스에 상속된 메서드와 속성을 제공합니다.

5. 인터페이스 구현 (Interface Implementation): 클래스가 인터페이스를 구현하는 경우.

    ```php
    class MyClass implements MyInterface {}
    ```

    인터페이스를 구현할 때 PHP는
    1. 인터페이스 정의를 메모리에 로드하여
    2. 구현된 메서드가 인터페이스 규약을 준수하는지 확인합니다.
